<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>May 24th 2019</title>
    <link rel="stylesheet" href="/assets/css/styles.css">
  </head>
  <body>
    <nav>
  
  
    <a href="/" >
      Home
    </a>
    
  
    <a href="https://www.linkedin.com/in/jordan-b-vidrine/" >
      LinkedIn
    </a>
    
</nav>

    <h1>May 24th 2019</h1>

<p>Today I worked more on the project for Sirius I wrote about yesterday. We will be using React as well as Recharts for React which uses d3 to create modular components for charts and graphs.</p>

<p>Today I created a fake set of data to use as a test for tank levels, and tank levelhistory. I also created a random level updater to mock when we would recieve data from the server that levels have changed. Heres what it looks like (very basic.)</p>

<p><img src="https://github.com/jordanvidrine/coding-journey/blob/master/Daily%20Logs/files/Screenshot_2019-05-24%20React%20App.png" alt="live tank simulation" /></p>

<p>Here is a bit of the code:</p>

<h4 id="main-app">Main App</h4>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">Component</span><span class="p">}</span> <span class="k">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Tank</span> <span class="k">from</span> <span class="s1">'./components/Tank'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">TankData</span> <span class="k">from</span> <span class="s1">'./data/TankData'</span>
<span class="k">import</span> <span class="nx">Chart</span> <span class="k">from</span> <span class="s1">'./components/Chart'</span>
<span class="k">import</span> <span class="s1">'./app.css'</span>

<span class="kd">class</span> <span class="nx">App</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">TankData</span><span class="p">:</span> <span class="p">[...</span><span class="nx">TankData</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">generateRandomLevels</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">generateRandomLevels</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">JSONify</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">JSONify</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">generateRandomLevels</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">tanks</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">TankData</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">newTimeStamp</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">toString</span><span class="p">().</span><span class="nx">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">).</span><span class="nx">splice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">' '</span><span class="p">);</span>
    <span class="nx">tanks</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">tank</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="c1">//save history of current water levels</span>
      <span class="nx">tank</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="na">water</span><span class="p">:</span> <span class="nx">tank</span><span class="p">.</span><span class="nx">currentH20Percent</span><span class="p">,</span> <span class="na">oil</span><span class="p">:</span> <span class="nx">tank</span><span class="p">.</span><span class="nx">currentOilPercent</span><span class="p">,</span> <span class="na">timeStamp</span><span class="p">:</span> <span class="nx">tank</span><span class="p">.</span><span class="nx">timeStamp</span><span class="p">});</span>

        <span class="c1">//randomize water levels</span>
        <span class="kd">let</span> <span class="nx">randomWater</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="mi">7</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">tank</span><span class="p">.</span><span class="nx">currentH20Percent</span> <span class="o">+</span> <span class="nx">randomWater</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">tank</span><span class="p">.</span><span class="nx">currentH20Percent</span> <span class="o">+=</span> <span class="nx">randomWater</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">tank</span><span class="p">.</span><span class="nx">currentH20Percent</span> <span class="o">-</span> <span class="nx">randomWater</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">tank</span><span class="p">.</span><span class="nx">currentH20Percent</span> <span class="o">-=</span> <span class="nx">randomWater</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span>

        <span class="c1">//randomize oil levels</span>
        <span class="kd">let</span> <span class="nx">randomOil</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="mi">10</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">tank</span><span class="p">.</span><span class="nx">currentOilPercent</span> <span class="o">+</span> <span class="nx">randomOil</span> <span class="o">&lt;=</span> <span class="mi">85</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">tank</span><span class="p">.</span><span class="nx">currentOilPercent</span> <span class="o">+=</span> <span class="nx">randomOil</span>
          <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">tank</span><span class="p">.</span><span class="nx">currentOilPercent</span> <span class="o">-</span> <span class="nx">randomOil</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">tank</span><span class="p">.</span><span class="nx">currentOilPercent</span> <span class="o">-=</span> <span class="nx">randomOil</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span>
      <span class="c1">//save new date to 'tank.date'</span>
      <span class="nx">tank</span><span class="p">.</span><span class="nx">timeStamp</span> <span class="o">=</span> <span class="nx">newTimeStamp</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="c1">//save state of water levels</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
      <span class="na">TankData</span><span class="p">:</span> <span class="p">[...</span><span class="nx">tanks</span><span class="p">]</span>
    <span class="p">})</span>
  <span class="p">}</span>

  <span class="nx">JSONify</span><span class="p">(){</span>
    <span class="kd">let</span> <span class="nx">dataJSON</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">TankData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">history</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">dataJSON</span><span class="p">)</span>
  <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>

      <span class="kd">let</span> <span class="nx">tanks</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">TankData</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">tank</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">&lt;</span><span class="nx">Tank</span> <span class="nx">tankInfo</span><span class="o">=</span><span class="p">{</span><span class="nx">tank</span><span class="p">}</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">tank</span><span class="p">.</span><span class="nx">tankName</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>      <span class="p">})</span>

      <span class="k">return</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"App"</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"tank-container"</span><span class="o">&gt;</span>
            <span class="p">{</span><span class="nx">tanks</span><span class="p">}</span>
            <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">generateRandomLevels</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Random</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">JSONify</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">JSONIFY</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="nx">Chart</span> <span class="nx">chartData</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">TankData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">history</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>      <span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="tank-component">Tank Component</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const Tank = props =&gt; {
  let t = props.tankInfo

  let waterStyles = {
    backgroundColor: 'blue',
    color: 'white',
    textAlign: 'center',
    height: (250*(t.currentH20Percent/100)),
    width: "200px",
  }

  let oilHeight = (250*(t.currentOilPercent/100))

  let oilStyles = {
    backgroundColor: 'grey',
    color: 'white',
    textAlign: 'center',
    height: oilHeight,
    width: "200px",
    marginTop: 250-oilHeight-(250*(t.currentH20Percent/100)),
  }

    return (
      &lt;div&gt;
      &lt;div id={t.tankName} className="outer-tank"&gt;
      &lt;div className="oil-tank" style={oilStyles}&gt;
      &lt;/div&gt;
        &lt;div className="water-tank" style={waterStyles}&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;h2&gt;{t.tankName}&lt;/h2&gt;
      &lt;p&gt;{t.time}&lt;/p&gt;
      &lt;/div&gt;
    )
  }

export default Tank
</code></pre></div></div>

<h4 id="chart-component">Chart Component</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import React from 'react';
import {
  LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend,
} from 'recharts';
import './chart.css'

const Chart = props =&gt; {

//important to distribute the data from the array into the array, not sure why it works like this
let propTankData = [...props.chartData];


  return (
    &lt;LineChart width={800} height={300} data={propTankData}
          margin=&gt;
     &lt;XAxis dataKey="timeStamp"/&gt;
     &lt;YAxis/&gt;
     &lt;CartesianGrid strokeDasharray="3 3"/&gt;
     &lt;Tooltip/&gt;
     &lt;Legend /&gt;
     &lt;Line type="monotone" dataKey="oil" stroke="#82ca9d" /&gt;
     &lt;Line type="monotone" dataKey="water" stroke="blue" /&gt;
    &lt;/LineChart&gt;
  )
}

export default Chart
</code></pre></div></div>


  </body>
</html>
